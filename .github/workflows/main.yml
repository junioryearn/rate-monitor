name: JPY Exchange Rate Monitor

on:
  # 1. 定时触发
  schedule:
    # 这里的语法是 cron 表达式
    # '0 * * * *' 代表每小时的第 0 分钟运行一次 (即每小时运行一次)
    # 注意：GitHub Actions 使用 UTC 时间，比北京时间慢8小时，但这不影响每小时执行的频率
    - cron: '0 * * * *'
  
  # 2. 手动触发 (方便你测试)
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # 第一步：下载你的代码仓库
    - name: Checkout code
      uses: actions/checkout@v2

    # 第二步：安装 Python 环境
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'

    # 第三步：安装依赖库 requests
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests

    # 第四步：运行脚本
    - name: Run monitor script
      env:
        # 这里把刚才设置的 Secret 传递给 Python 脚本的环境变量
        PUSHPLUS_TOKEN: ${{ secrets.PUSHPLUS_TOKEN }}
      run: python monitor.py
